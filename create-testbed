#!/bin/bash
set -e

tmpdir="/tmp/mob"
localdir="${tmpdir}/local"
remotedir="${tmpdir}/remote"
echo "localdir=${localdir}"
mkdir -p "${localdir}" "${remotedir}"
rm -rf "${localdir}" "${remotedir}"
mkdir -p "${localdir}" "${remotedir}"

(cd "${remotedir}" && git --bare init)
(cd "${localdir}" && git clone --origin origin "file://${remotedir}" . && echo "test" >test.txt && git add . && git commit -m "initial import" && git push --set-upstream --all origin)

# optional
localotherdir="${tmpdir}/localother"
echo "localotherdir=${localotherdir}"
rm -rf "${localotherdir}"
mkdir -p "${localotherdir}"
(cd "${localotherdir}" && git clone --origin origin "file://${remotedir}" .)
